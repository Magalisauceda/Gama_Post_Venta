<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GAMA ¬∑ Postventa (M√≥dulo 4) - GAMA</title>
<style>
:root{--oro:#b98b3b;--cobre:#b66b3a;--beige:#f2eadf;--marfil:#fffaf0;--accent:#3b2f2a;--muted:#6f5f52}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--marfil);color:var(--accent);min-height:100vh;display:flex;flex-direction:column}
header{background:linear-gradient(90deg,var(--oro),var(--cobre));color:#fff;padding:14px 18px;font-weight:700}
.container{width:100%;max-width:980px;margin:18px auto;padding:12px}
.card{background:var(--beige);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,0.07)}
.h1{font-size:20px;color:var(--accent);margin:0 0 8px}
.small{color:var(--muted);font-size:14px}
#contador{color:var(--cobre);font-weight:700;margin-top:12px}
.options{margin-top:16px}
.options button{display:block;width:100%;max-width:680px;margin:10px auto;text-align:left;padding:12px 14px;border-radius:10px;border:2px solid var(--cobre);background:#fff;cursor:pointer;font-size:16px}
.options button:hover{background:linear-gradient(90deg,#fff,#f7f2ea)}
.progress{margin-top:12px;color:var(--muted)}
.popup{display:none;position:fixed;left:50%;top:18%;transform:translateX(-50%);background:#fff;padding:18px;border-radius:12px;border:2px solid var(--oro);box-shadow:0 12px 40px rgba(0,0,0,0.14);width:90%;max-width:420px;z-index:120}
.center{display:flex;flex-direction:column;align-items:center;gap:8px}
.footer{background:var(--oro);color:#fff;padding:10px;text-align:center;font-size:13px}
.hidden{display:none}
@media(min-width:720px){.options button{max-width:700px}}
</style>
</head>
<body>
<header>üå≥ GAMA ¬∑ Seguimiento Postventa ‚Äî M√≥dulo 4</header>

<main class="container">
  <div class="card" id="welcome">
    <div class="h1">Bienvenida ‚Äî Seguimiento Postventa</div>
    <div class="small">Instrucciones: haz <strong>un clic</strong> para activar sonido. Responde cada pregunta; tendr√°s tiempo por pregunta. Usa los popups para leer feedback y continuar.</div>
    <div style="margin-top:14px" class="center">
      <button id="startBtn">üéß Iniciar ejercicio</button>
      <div id="contador" class="small">Tiempo: <span id="timeLabel">30</span>s</div>
    </div>
  </div>

  <div class="card hidden" id="game">
    <div id="qwrap"></div>
    <div class="progress small">Progreso: <span id="progress">0 / 0</span></div>
  </div>
</main>

<div class="popup" id="popup" role="dialog" aria-modal="true" aria-hidden="true">
  <div id="popupText" class="small"></div>
  <div style="margin-top:12px;text-align:right">
    <button id="popupBtn">Continuar</button>
  </div>
</div>

<footer class="footer">
  Magali Sauceda¬Æ | Mentora Inmobiliaria | Fundadora de Ra√≠ces de √âxito ‚Äî Metodolog√≠a SPIN‚Ñ¢
</footer>

<script>
/* ---------------- audio helper ---------------- */
function A(src){ try{return new Audio(encodeURI(src));}catch(e){return new Audio(src);} }

/* ---------- archivos EXACTOS que subiste ---------- */
const FILES = {
  music: "m√∫sica de videojuegos arcade retro-297305.mp3",
  tiktak: "TIKTACK.mp3",
  pop: "POP.mp3",
  bien: "BIEN.mp3",
  no: "NO.mp3",
  tonto: "TONTO.mp3",
  aplausos: "APLAUSOS.mp3",
  fanfarrea: "FANFARREA.mp3",
  bonus: "BONUS.mp3"
};

/* ---------- precarga sonidos ---------- */
const S = {
  music: A(FILES.music),
  tiktak: A(FILES.tiktak),
  pop: A(FILES.pop),
  bien: A(FILES.bien),
  no: A(FILES.no),
  tonto: A(FILES.tonto),
  aplausos: A(FILES.aplausos),
  fanfarrea: A(FILES.fanfarrea),
  bonus: A(FILES.bonus)
};
S.music.loop = true; S.tiktak.loop = true;
S.music.volume = 0.55; S.tiktak.volume = 0.35;

/* ---------- preguntas (editar si quieres) ---------- */
const PREG = [
  { q:"¬øQu√© significa SPIN en ventas?", 
    options:["Situaci√≥n, Problema, Implicaci√≥n, Necesidad","Saber, Planear, Invertir, Negociar","Sistema, Proceso, Inversi√≥n, Negocio"], correct:0, explain:"SPIN = Situaci√≥n, Problema, Implicaci√≥n, Necesidad." },
  { q:"¬øQu√© mide el NPS?", 
    options:["Nivel de Promoci√≥n y Satisfacci√≥n","Net Promoter Score o Nivel de Recomendaci√≥n","Negociaci√≥n Profesional de Servicio"], correct:1, explain:"NPS mide la probabilidad de recomendaci√≥n (1-10)." },
  { q:"¬øQu√© es un pipeline en ventas?",
    options:["Sistema para visualizar en qu√© etapa est√° cada cliente","Documento de escritura p√∫blica","Lista de precios"], correct:0, explain:"Pipeline = flujo/etapas del proceso de venta." }
];

let idx = 0, score = 0;
let questionTimer = null, timeLeft = 30;

/* DOM */
const startBtn = document.getElementById('startBtn');
const welcome = document.getElementById('welcome');
const game = document.getElementById('game');
const qwrap = document.getElementById('qwrap');
const popup = document.getElementById('popup');
const popupText = document.getElementById('popupText');
const popupBtn = document.getElementById('popupBtn');
const timeLabel = document.getElementById('timeLabel');
const progress = document.getElementById('progress');
const contadorEl = document.getElementById('contador');

/* set progress initial */
progress.textContent = `${idx+1} / ${PREG.length}`;

/* ensure audio can play after first user interaction */
function ensureAudioOnFirstInteraction(){
  document.body.addEventListener('click', function once(){
    S.music.play().catch(()=>{/* bloqueado, OK */});
    document.body.removeEventListener('click', once);
  }, { once:true });
}

/* start */
startBtn.addEventListener('click', ()=>{
  ensureAudioOnFirstInteraction();
  S.music.play().catch(()=>{});
  welcome.classList.add('hidden');
  game.classList.remove('hidden');
  idx = 0; score = 0;
  renderQuestion();
});

/* render question */
function renderQuestion(){
  clearInterval(questionTimer);
  S.tiktak.currentTime = 0;
  timeLeft = 30; timeLabel.textContent = timeLeft;
  S.tiktak.play().catch(()=>{});
  const P = PREG[idx];
  progress.textContent = `${idx+1} / ${PREG.length}`;
  qwrap.innerHTML = `
    <div class="card" style="padding:14px;">
      <h2>${P.q}</h2>
      <div class="options" id="optionsWrap">
        ${P.options.map((o,i)=>`<button data-i="${i}" onclick="selectOption(${i})">${String.fromCharCode(65+i)}) ${o}</button>`).join('')}
      </div>
    </div>
  `;
  // contador
  questionTimer = setInterval(()=>{
    timeLeft--; timeLabel.textContent = timeLeft;
    if(timeLeft <= 5) contadorEl.style.color = 'var(--cobre)';
    if(timeLeft <= 0){
      clearInterval(questionTimer);
      S.tiktak.pause();
      S.no.play().catch(()=>{});
      showPopup('‚è∞ Tiempo agotado. ' + P.explain, false);
    }
  },1000);
}

/* handle selection */
function selectOption(sel){
  // disable buttons to avoid double clicks
  const btns = document.querySelectorAll('#optionsWrap button');
  btns.forEach(b=>b.disabled = true);
  clearInterval(questionTimer);
  S.tiktak.pause();
  S.pop.play().catch(()=>{});
  const P = PREG[idx];
  const correcto = (sel === P.correct);
  if(correcto){
    score++;
    S.bien.play().catch(()=>{});
    showPopup('‚úÖ Correcto. ' + P.explain, true);
  } else {
    S.no.play().catch(()=>{});
    showPopup('‚ùå No es correcto. ' + P.explain, false);
  }
}

/* show popup */
function showPopup(text, positive){
  popupText.textContent = text;
  popup.dataset.positive = positive ? '1' : '0';
  popup.style.display = 'block';
  popup.setAttribute('aria-hidden','false');
  // focus the button so user can press Enter
  popupBtn.focus();
}

/* close popup and control flow */
function closePopup(){
  popup.style.display = 'none';
  popup.setAttribute('aria-hidden','true');
  const positive = popup.dataset.positive === '1';
  if(positive){
    idx++;
    // small delay so user perceives feedback
    if(idx < PREG.length){
      setTimeout(renderQuestion, 450);
      return;
    } else {
      // finished
      S.music.pause();
      S.fanfarrea.play().catch(()=>{ S.aplausos.play().catch(()=>{}); });
      qwrap.innerHTML = `<div class="card"><h2>üéâ ¬°Has completado el m√≥dulo con √©xito!</h2><p class="small">Puntuaci√≥n: ${score} / ${PREG.length}</p></div>`;
      return;
    }
  } else {
    // repeat same question
    setTimeout(renderQuestion, 300);
  }
}

/* connect popup button */
popupBtn.addEventListener('click', closePopup);

/* expose selectOption globally (onclick uses it) */
window.selectOption = selectOption;

/* prepare first-interaction audio allowance */
ensureAudioOnFirstInteraction();
</script>
</body>
</html>
