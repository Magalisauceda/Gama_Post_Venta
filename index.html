<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üå≥ GAMA Post Venta ‚Äî Simulador SPIN</title>
<style>
body{font-family:"Segoe UI",Roboto,sans-serif;background:#f8f3ec;margin:0;color:#3b2f2a}
.wrap{max-width:900px;margin:20px auto;padding:20px;background:#fffaf0;border-radius:10px;border:2px solid #b66b3a}
h1{color:#b98b3b;text-align:center}
button{cursor:pointer;border:none;border-radius:8px;padding:10px 14px;font-weight:700}
.btn{background:#b98b3b;color:#fff;margin:5px}
.btn:hover{background:#9a742e}
.opt-btn{display:block;width:100%;text-align:left;margin:8px 0;padding:10px;border:2px solid #b66b3a;border-radius:8px;background:#fff;font-weight:700}
.opt-btn:hover{background:#b66b3a;color:#fff}
.hidden{display:none}
.good{color:#2ecc71;font-weight:700}
.bad{color:#e74c3c;font-weight:700}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:2000}
.modal-card{background:#fff;padding:20px;border-radius:10px;max-width:600px;width:90%}
</style>
</head>
<body>
<div class="wrap">
  <h1>üå≥ Bienvenida a GAMA Post Venta</h1>
  <p style="text-align:center">Responde correctamente todas las preguntas SPIN. Las falladas se repiten hasta lograr 100%.</p>
  <div id="intro">
    <div style="text-align:center">
      <button id="startBtn" class="btn">‚ú® Iniciar Simulador</button>
    </div>
  </div>

  <div id="game" class="hidden">
    <div id="questionText" style="font-weight:900;font-size:18px;margin-top:10px;"></div>
    <div id="optionsWrap"></div>
    <div id="feedbackArea" style="min-height:40px;margin-top:8px;"></div>
    <button id="nextBtn" class="btn hidden">Siguiente ‚û°Ô∏è</button>
    <div style="margin-top:10px;text-align:right;color:#6f5f52" id="progressText"></div>
  </div>
</div>

<!-- FINAL -->
<div id="finalModal" class="modal hidden" aria-hidden="true">
  <div class="modal-card">
    <h2>üéâ ¬°Perfecto! Has logrado el 100%</h2>
    <p>Repetiste hasta corregir todas las preguntas. Excelente desempe√±o.</p>
    <div style="text-align:right">
      <button id="restartBtn" class="btn">Volver a Entrenar</button>
    </div>
  </div>
</div>

<script>
const BANK = [
  {text:'¬øQu√© significa SPIN en ventas?',
   options:['Situaci√≥n, Problema, Implicaci√≥n, Necesidad','Saber, Planear, Invertir, Negociar','Sistema, Proceso, Inversi√≥n, Negocio'],
   correct:'Situaci√≥n, Problema, Implicaci√≥n, Necesidad',
   explain:'SPIN = Situaci√≥n (hechos), Problema (dolor), Implicaci√≥n (consecuencia), Necesidad (deseo o resultado).'},
  {text:'¬øQu√© mide el NPS?',
   options:['Nivel de recomendaci√≥n del cliente (1-10)','Nivel de ventas mensuales','N√∫mero de propiedades vendidas'],
   correct:'Nivel de recomendaci√≥n del cliente (1-10)',
   explain:'NPS = Net Promoter Score: mide qu√© tan probable es que un cliente te recomiende.'},
  {text:'¬øQu√© es un pipeline en ventas?',
   options:['El embudo de etapas de prospecto a cliente','Un contrato de compraventa','Un software de facturaci√≥n'],
   correct:'El embudo de etapas de prospecto a cliente',
   explain:'Pipeline = flujo o embudo comercial que te ayuda a medir avances y cierres.'},
  {text:'¬øCu√°ndo es mejor pedir referidos?',
   options:['Cuando el cliente demuestra satisfacci√≥n real','Al primer contacto','Al firmar sin seguimiento'],
   correct:'Cuando el cliente demuestra satisfacci√≥n real',
   explain:'Postventa: pedir referidos cuando hay emoci√≥n positiva y confianza real.'},
  {text:'¬øQu√© pregunta revela la situaci√≥n financiera del cliente?',
   options:['¬øCon qu√© recursos planea la compra (propios, cr√©dito)?','¬øLe gusta la zona?','¬øCu√°ntos cuartos busca?'],
   correct:'¬øCon qu√© recursos planea la compra (propios, cr√©dito)?',
   explain:'Detectar recursos financieros evita perder tiempo con prospectos no calificados.'}
];

let pool = [];
let missed = [];
let currentIndex = 0;
let started = false;

const intro = document.getElementById('intro');
const game = document.getElementById('game');
const startBtn = document.getElementById('startBtn');
const questionText = document.getElementById('questionText');
const optionsWrap = document.getElementById('optionsWrap');
const feedbackArea = document.getElementById('feedbackArea');
const nextBtn = document.getElementById('nextBtn');
const progressText = document.getElementById('progressText');
const finalModal = document.getElementById('finalModal');
const restartBtn = document.getElementById('restartBtn');

startBtn.onclick = ()=> startGame();

function startGame(){
  started = true;
  intro.classList.add('hidden');
  game.classList.remove('hidden');
  pool = shuffle([...BANK]);
  missed = [];
  currentIndex = 0;
  renderQuestion();
}

function renderQuestion(){
  feedbackArea.textContent = '';
  nextBtn.classList.add('hidden');
  if(!pool[currentIndex]){
    if(missed.length>0){
      pool = shuffle([...missed]);
      missed=[];
      currentIndex=0;
      renderQuestion();
      return;
    }else{
      showFinal();
      return;
    }
  }
  const q = pool[currentIndex];
  questionText.textContent = q.text;
  optionsWrap.innerHTML = '';
  const opts = shuffle([...q.options]);
  opts.forEach(opt=>{
    const b=document.createElement('button');
    b.className='opt-btn';
    b.textContent=opt;
    b.onclick=()=>checkAnswer(opt,q);
    optionsWrap.appendChild(b);
  });
  progressText.textContent=`Pregunta ${currentIndex+1} de ${pool.length}`;
}

function checkAnswer(choice,q){
  Array.from(document.querySelectorAll('.opt-btn')).forEach(b=>b.disabled=true);
  if(choice===q.correct){
    feedbackArea.innerHTML=`<div class="good">‚úÖ Correcto.</div><div style="font-size:14px">${q.explain}</div>`;
  }else{
    feedbackArea.innerHTML=`<div class="bad">‚ùå Incorrecto.</div><div style="font-size:14px">Respuesta correcta: <b>${q.correct}</b><br>${q.explain}</div>`;
    if(!missed.includes(q)) missed.push(q);
  }
  nextBtn.classList.remove('hidden');
}

nextBtn.onclick=()=>{currentIndex++;renderQuestion();}

restartBtn.onclick=()=>{
  finalModal.classList.add('hidden');
  intro.classList.remove('hidden');
  game.classList.add('hidden');
  started=false;
};

function showFinal(){
  finalModal.classList.remove('hidden');
  finalModal.setAttribute('aria-hidden','false');
}

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
</script>
</body>
</html>
