<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GAMA ¬∑ Postventa (M√≥dulo 4)</title>
<style>
:root{
  --oro:#b98b3b; --cobre:#b66b3a; --beige:#f2eadf; --marfil:#fffaf0; --accent:#3b2f2a; --muted:#6f5f52;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:Inter,Arial,Helvetica,sans-serif;
  background:var(--marfil); color:var(--accent);
  display:flex;flex-direction:column;min-height:100vh;
}
header{background:linear-gradient(90deg,var(--oro),var(--cobre));color:#fff;padding:14px 18px;font-weight:700}
.container{width:100%;max-width:980px;margin:18px auto;padding:12px;flex:1}
.card{background:var(--beige);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,0.07)}
.h1{font-size:20px;color:var(--accent);margin:0 0 8px}
.small{color:var(--muted);font-size:14px}
#contador{color:var(--cobre);font-weight:700;margin-top:12px}
.options{margin-top:16px}
.options button{display:block;width:100%;max-width:760px;margin:10px auto;text-align:left;padding:12px 14px;border-radius:10px;border:2px solid var(--cobre);background:#fff;cursor:pointer;font-size:16px}
.options button:hover{background:linear-gradient(90deg,#fff,#f7f2ea)}
.progress{margin-top:12px;color:var(--muted)}
.popup{display:none;position:fixed;left:50%;top:18%;transform:translateX(-50%);background:#fff;padding:18px;border-radius:12px;border:2px solid var(--oro);box-shadow:0 12px 40px rgba(0,0,0,0.14);width:90%;max-width:540px;z-index:120}
.center{display:flex;flex-direction:column;align-items:center;gap:8px}
.footer{background:var(--oro);color:#fff;padding:10px;text-align:center;font-size:13px}
.hidden{display:none}
.badge{display:inline-block;background:#fff;padding:6px 10px;border-radius:20px;border:2px solid var(--cobre);font-weight:600;color:var(--cobre);margin-left:8px}
@media(min-width:720px){.options button{max-width:700px}}
</style>
</head>
<body>
<header>üå≥ GAMA ¬∑ Seguimiento Postventa ‚Äî M√≥dulo 4</header>

<main class="container">
  <!-- Bienvenida -->
  <div class="card" id="welcomeCard" aria-live="polite">
    <div class="h1">Bienvenida ‚Äî Seguimiento Postventa</div>
    <div class="small">Instrucciones: haz <strong>un clic</strong> en la p√°gina para activar el audio. Pulsa <strong>Iniciar ejercicio</strong> y responde cada pregunta. El objetivo: alcanzar 100% de aciertos. Si no llegas, podr√°s repetir hasta lograrlo.</div>
    <div style="margin-top:14px" class="center">
      <button id="startBtn">üéß Iniciar ejercicio</button>
      <div id="contador" class="small">Tiempo por pregunta: <span id="timeLabel">30</span>s <span class="badge" id="progressBadge">0 / 0</span></div>
    </div>
  </div>

  <!-- Juego -->
  <div class="card hidden" id="gameCard">
    <div id="qwrap" aria-live="polite"></div>
    <div class="progress small">Progreso: <span id="progress">0 / 0</span></div>
  </div>
</main>

<!-- Popup -->
<div class="popup" id="popup" role="dialog" aria-modal="true" aria-hidden="true">
  <div id="popupText" class="small"></div>
  <div style="margin-top:12px;text-align:right">
    <button id="popupBtn">Continuar</button>
  </div>
</div>

<footer class="footer">
  Magali Sauceda¬Æ | Mentora Inmobiliaria | Fundadora de Ra√≠ces de √âxito ‚Äî Metodolog√≠a SPIN‚Ñ¢
</footer>

<script>
/* ---------------- audio helper ---------------- */
function A(src){ try{return new Audio(encodeURI(src));}catch(e){return new Audio(src);} }

/* ---------- archivos EXACTOS que subiste ---------- */
const FILES = {
  music: "m√∫sica de videojuegos arcade retro-297305.mp3",
  tiktak: "TIKTACK.mp3",
  pop: "POP.mp3",
  bien: "BIEN.mp3",
  no: "NO.mp3",
  tonto: "TONTO.mp3",
  aplausos: "APLAUSOS.mp3",
  fanfarrea: "FANFARREA.mp3",
  bonus: "BONUS.mp3"
};

/* ---------- precarga sonidos ---------- */
const S = {
  music: A(FILES.music),
  tiktak: A(FILES.tiktak),
  pop: A(FILES.pop),
  bien: A(FILES.bien),
  no: A(FILES.no),
  tonto: A(FILES.tonto),
  aplausos: A(FILES.aplausos),
  fanfarrea: A(FILES.fanfarrea),
  bonus: A(FILES.bonus)
};
S.music.loop = true; S.tiktak.loop = true;
S.music.volume = 0.55; S.tiktak.volume = 0.35;

/* ---------------- PREGUNTAS (Postventa - M√≥dulo 4) --------------- 
   Son 10 preguntas pensadas en cronograma, NPS, pipeline, referidos, m√©tricas y postventa.
   Puedes editar las preguntas aqu√≠ directamente si quieres cambiar texto.
*/
const PREG = [
  { q:"¬øCu√°l es el objetivo del cronograma postventa?", 
    options:["Organizar contactos con prop√≥sito y fechas","Llamar cuando te acuerdes","Enviar promociones sin filtro"], correct:0, explain:"Cada contacto tiene un objetivo (reafirmar compra, resolver dudas, preparar referido)." },
  { q:"¬øQu√© es lo que mide el NPS (Net Promoter Score)?",
    options:["Probabilidad de recomendaci√≥n del cliente","Satisfacci√≥n con el precio","Velocidad del tr√°mite"], correct:0, explain:"NPS mide la recomendaci√≥n: 9-10 promotores, 7-8 pasivos, 1-6 detractores." },
  { q:"¬øPor qu√© es importante medir satisfacci√≥n con preguntas profesionales?",
    options:["Para obtener informaci√≥n √∫til y mejorar procesos","Para decir 'todo bien' y ya","Para cerrar ventas inmediatas sin feedback"], correct:0, explain:"Preguntas abiertas + escalas dan datos accionables." },
  { q:"¬øQu√© es un pipeline en ventas?", 
    options:["Un sistema para visualizar las etapas de cada cliente","Un tipo de contrato","Una herramienta contable"], correct:0, explain:"Pipeline = etapas y acciones necesarias para avanzar prospectos." },
  { q:"¬øCu√°ndo es buen momento para solicitar referidos?", 
    options:["Cuando el cliente demuestra satisfacci√≥n real","Antes de la firma","Al primer contacto sin medir satisfacci√≥n"], correct:0, explain:"Pedir referidos a promotores maximiza √©xito." },
  { q:"¬øQu√© indicadores pueden usarse como m√©tricas postventa?", 
    options:["NPS, tasa de referidos, % de satisfacci√≥n y tasa de respuesta","Solo ventas","Solo visitas"], correct:0, explain:"M√©tricas permiten evaluar y mejorar el proceso." },
  { q:"¬øQu√© se busca al identificar nuevas oportunidades con clientes actuales?", 
    options:["Detectar cambios de vida o econ√≥micos que generen nuevas necesidades","Presionar para vender m√°s","Ignorar al cliente una vez firmado"], correct:0, explain:"Cambios personales (bodas, hijos, negocio) generan nuevas ventas." },
  { q:"¬øQu√© herramienta facilita el seguimiento organizado?", 
    options:["CRM con plantillas y automatizaciones","Notas aisladas en papel","Mensajes improvisados en chats"], correct:0, explain:"CRM + automatizaci√≥n evita olvidos y permite medir resultados." },
  { q:"¬øQu√© hacer si un cliente est√° en 7-8 en la escala NPS?", 
    options:["Preguntar '¬øQu√© tendr√≠a que pasar para que fuera un 10?'","Ignorarlo","Mandar publicidad sin contacto"], correct:0, explain:"Esa pregunta revela mejoras concretas para convertirlo en promotor." },
  { q:"¬øCu√°l es el valor de un seguimiento postventa profesional?", 
    options:["Fidelizar clientes, generar referidos y detectar nuevas ventas","Aumentar trabajo sin resultados","Solo cumplir tr√°mites"], correct:0, explain:"Un buen seguimiento multiplica oportunidades y retenci√≥n." }
];

/* estado */
let idx = 0, score = 0;
let questionTimer = null, timeLeft = 30;

/* DOM */
const startBtn = document.getElementById('startBtn');
const welcomeCard = document.getElementById('welcomeCard');
const gameCard = document.getElementById('gameCard');
const qwrap = document.getElementById('qwrap');
const popup = document.getElementById('popup');
const popupText = document.getElementById('popupText');
const popupBtn = document.getElementById('popupBtn');
const timeLabel = document.getElementById('timeLabel');
const progress = document.getElementById('progress');
const progressBadge = document.getElementById('progressBadge');
const contadorEl = document.getElementById('contador');

/* init display values */
progress.textContent = `0 / ${PREG.length}`;
progressBadge.textContent = `0 / ${PREG.length}`;

/* asegurar que el primer click permita audio */
function allowAudioOnFirstClick(){
  document.body.addEventListener('click', function once(){
    S.music.play().catch(()=>{/* bloqueo posible */});
    document.body.removeEventListener('click', once);
  }, { once:true });
}

/* START */
startBtn.addEventListener('click', ()=>{
  allowAudioOnFirstClick();
  S.music.play().catch(()=>{});
  welcomeCard.classList.add('hidden');
  gameCard.classList.remove('hidden');
  idx = 0; score = 0;
  renderQuestion();
});

/* render question */
function renderQuestion(){
  clearInterval(questionTimer);
  S.tiktak.currentTime = 0;
  timeLeft = 30;
  timeLabel.textContent = timeLeft;
  S.tiktak.play().catch(()=>{});
  const P = PREG[idx];
  progress.textContent = `${idx+1} / ${PREG.length}`;
  progressBadge.textContent = `${idx+1} / ${PREG.length}`;
  qwrap.innerHTML = `
    <div class="card" style="padding:14px">
      <h2>${P.q}</h2>
      <div class="options" id="optionsWrap">
        ${P.options.map((o,i)=>`<button data-i="${i}" onclick="selectOption(${i})">${String.fromCharCode(65+i)}) ${o}</button>`).join('')}
      </div>
      <div style="margin-top:12px" class="small">Progreso: ${idx+1} / ${PREG.length} ‚Äî Puntos: ${score}</div>
    </div>
  `;
  // contador por pregunta
  questionTimer = setInterval(()=>{
    timeLeft--; timeLabel.textContent = timeLeft;
    if(timeLeft <= 5) contadorEl.style.color = 'var(--cobre)';
    if(timeLeft <= 0){
      clearInterval(questionTimer);
      S.tiktak.pause();
      S.no.play().catch(()=>{});
      showPopup('‚è∞ Tiempo agotado. ' + P.explain, false);
    }
  },1000);
}

/* select option (llamado por onclick) */
function selectOption(sel){
  const btns = document.querySelectorAll('#optionsWrap button');
  btns.forEach(b=>b.disabled=true);
  clearInterval(questionTimer);
  S.tiktak.pause();
  S.pop.play().catch(()=>{});
  const P = PREG[idx];
  const correcto = (sel === P.correct);
  if(correcto){
    score++;
    S.bien.play().catch(()=>{});
    showPopup('‚úÖ Correcto. ' + P.explain, true);
  } else {
    S.no.play().catch(()=>{});
    showPopup('‚ùå No es correcto. ' + P.explain, false);
  }
}

/* show popup */
function showPopup(text, positive){
  popupText.textContent = text;
  popup.dataset.positive = positive ? '1' : '0';
  popup.style.display = 'block';
  popup.setAttribute('aria-hidden','false');
  popupBtn.focus();
}

/* close popup y control de flujo */
function closePopup(){
  popup.style.display = 'none';
  popup.setAttribute('aria-hidden','true');
  const positive = popup.dataset.positive === '1';
  if(positive){
    idx++;
    if(idx < PREG.length){
      setTimeout(renderQuestion, 450);
      return;
    } else {
      // termin√≥ el ciclo: si score == total -> 100% perfecto, si no -> pedir repetir hasta lograr 100%
      S.music.pause();
      // Reproducir fanfarria y aplausos si fue perfecto
      if(score === PREG.length){
        S.fanfarrea.play().catch(()=>{ S.aplausos.play().catch(()=>{}); });
        qwrap.innerHTML = `<div class="card"><h2>üéâ ¬°Perfecto! Alcanzaste 100%.</h2><p class="small">Puntuaci√≥n: ${score} / ${PREG.length}</p><div style="margin-top:12px"><button onclick="restart()">Volver a jugar</button></div></div>`;
      } else {
        // si no fue perfecto, mostrar mensaje y bot√≥n para reintentar (reset conservando aprendizaje)
        S.bonus.play().catch(()=>{});
        qwrap.innerHTML = `<div class="card"><h2>üåø Buen intento ‚Äî a√∫n no es 100%</h2><p class="small">Puntuaci√≥n: ${score} / ${PREG.length}</p><p class="small">Repite hasta alcanzar 100% para certificar la pr√°ctica.</p><div style="margin-top:12px"><button onclick="retry()">Reintentar m√≥dulo</button></div></div>`;
      }
      return;
    }
  } else {
    // repetir misma pregunta
    setTimeout(renderQuestion, 300);
  }
}

/* retry: volver a empezar desde la primera pregunta con score a 0 */
function retry(){
  idx = 0; score = 0;
  S.music.play().catch(()=>{});
  renderQuestion();
}

/* restart: opci√≥n cuando ya lleg√≥ a 100% y quiere repetir */
function restart(){
  idx = 0; score = 0;
  S.music.play().catch(()=>{});
  renderQuestion();
}

/* conectar popupBtn */
popupBtn.addEventListener('click', closePopup);

/* exponer selectOption por si algo inline lo llama */
window.selectOption = selectOption;

/* permitir audio en primer clic (navegadores) */
allowAudioOnFirstClick();
</script>
</body>
</html>
