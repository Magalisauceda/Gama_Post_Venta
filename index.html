<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>GAMA Post Venta - MVP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --oro: #b98b3b;
      --cobre: #b66b3a;
      --beige: #f2eadf;
      --marfil: #fffaf0;
      --text: #1a1a1a;
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; font-family: Arial, sans-serif; background: #fff; color: var(--text); }
    .container { max-width: 900px; margin: 0 auto; padding: 20px; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 2px solid #eee; }
    h1 { font-size: 1.25rem; color: var(--marfil); background: var(--oro); padding: 8px 12px; border-radius: 6px; }
    #score { font-weight: bold; }
    .screen { min-height: 420px; padding: 20px; }
    .card { background: #fff; border: 1px solid #ddd; border-radius: 10px; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,.05); }
    .pregunta { font-size: 1.1rem; margin-bottom: 12px; }
    .opcion { display: block; width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #ccc; background: #f7f7f7; cursor: pointer; text-align: left; }
    .opcion:hover { background: #ececec; }
    .btn { padding: 12px 16px; border: none; border-radius: 8px; background: var(--cobre); color: white; cursor: pointer; }
    .btn.secondary { background: #666; }
    .popup { margin-top: 10px; padding: 10px; background: #eef6ff; border: 1px solid #cfe0ff; border-radius: 8px; }
    footer { margin-top: 12px; text-align: right; }
    @media (min-width: 700px) {
      .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    }
  </style>
</head>
<body>
  <div class="container" id="app" aria-label="Simulador SPIN Post Venta MVP">
    <header>
      <div><strong>GAMA Post Venta</strong> - MVP</div>
      <div id="score" aria-live="polite">Comisión: 0</div>
    </header>

    <section class="screen" id="screen" aria-label="Pantalla de juego">
      <!-- se carga dinámicamente -->
    </section>

    <footer>
      <button id="btn-retry" class="btn" style="display:none">Reintentar hasta 100%</button>
    </footer>
  </div>

  <script>
    // data simple (2 fases x 3 preguntas cada una)
    const preguntasFases = [
      {
        fase: "SPIN",
        preguntas: [
          { pregunta: "1) ¿Qué necesidad busca el cliente en la postventa?", opciones: ["A. Comodidad", "B. Respuesta rápida", "C. Documentación clara"], respuestaIndex: 1, explicacion: "En SPIN, entender la necesidad es clave." },
          { pregunta: "2) ¿Qué pregunta ayuda a identificar la Situación?", opciones: ["A. ¿Qué pasó?", "B. ¿Qué tipo de seguimiento desea?", "C. ¿Cuándo compró la propiedad?"], respuestaIndex: 1, explicacion: "La pregunta de Situación orienta el contexto." },
          { pregunta: "3) ¿Qué opción describe mejor una Pregunta de Necesidad?", opciones: ["A. Busca información de la competencia", "B. Indaga beneficios futuros", "C. Cierra la venta ya"], respuestaIndex: 1, explicacion: "Las preguntas de necesidad exploran beneficios futuros." }
        ]
      },
      {
        fase: "CAPTACION",
        preguntas: [
          { pregunta: "4) En CAPTACIÓN, ¿qué se valida?", opciones: ["A. Interés del cliente", "B. Ubicación de la oficina", "C. Color de la fachada"], respuestaIndex: 0, explicacion: "Se valida interés y próximos pasos." },
          { pregunta: "5) ¿Qué técnica ayuda a priorizar seguimientos?", opciones: ["A. Llamar una vez", "B. Cronómetro y plan de acción", "C. Enviar correo sin respuesta"], respuestaIndex: 1, explicacion: "El plan de acción mejora la organización." },
          { pregunta "6) ¿Qué es clave para evitar objeciones?", opciones: ["A. Escuchar", "B. Hablar mucho", "C. Evitar preguntas"], respuestaIndex: 0, explicacion: "La escucha activa reduce objeciones." }
        ]
      }
    ];

    // estado mínimo
    let estado = {
      faseIndex: 0,
      preguntaIndex: 0,
      aciertos: 0,
      errores: 0,
      comision: 0
    };

    const app = document.getElementById('app');
    const screen = document.getElementById('screen');
    const scoreEl = document.getElementById('score');
    const btnRetry = document.getElementById('btn-retry');

    function actualizarScore() {
      scoreEl.textContent = "Comisión: " + estado.comision;
      scoreEl.setAttribute('aria-label', 'Comisión actual: ' + estado.comision);
    }

    function renderBienvenida() {
      screen.innerHTML = `
        <div class="card">
          <p>Bienvenido al simulador SPIN Post Venta (MVP).</p>
          <p>Inicia para practicar 2 fases con preguntas cronometradas, feedback y una comisión simulada.</p>
          <button id="btn-iniciar" class="btn">Iniciar simulador</button>
        </div>
      `;
      document.getElementById('btn-iniciar').addEventListener('click', iniciar);
    }

    function iniciar() {
      estado = { faseIndex: 0, preguntaIndex: 0, aciertos: 0, errores: 0, comision: 0 };
      cargarPregunta();
      actualizarScore();
    }

    function cargarPregunta() {
      const fase = preguntasFases[estado.faseIndex];
      const pIdx = estado.preguntaIndex;
      if (!fase || !fase.preguntas[pIdx]) {
        // terminar
        finalizar();
        return;
      }
      const p = fase.preguntas[pIdx];
      screen.innerHTML = `
        <div class="card" role="region" aria-label="Pregunta de la fase ${fase.fase}">
          <div class="pregunta">${p.pregunta}</div>
          ${p.opciones.map((op, i) => `<button class="opcion" data-i="${i}">${op}</button>`).join('')}
          <div class="popup" id="popup" style="display:none" aria-live="polite"></div>
        </div>
      `;
      document.querySelectorAll('.opcion').forEach(btn => {
        btn.addEventListener('click', () => evaluar(parseInt(btn.dataset.i, 10)));
      });
    }

    function evaluar(i) {
      const fase = preguntasFases[estado.faseIndex];
      const p = fase.preguntas[estado.preguntaIndex];
      const correcto = i === p.respuestaIndex;
      const popup = document.getElementById('popup');
      if (correcto) {
        estado.aciertos++;
        estado.comision += 10;
        popup.textContent = "Correcto: " + p.explicacion;
      } else {
        estado.errores++;
        estado.comision -= 5;
        popup.textContent = "Incorrecto: " + p.explicacion;
      }
      popup.style.display = 'block';
      setTimeout(() => {
        popup.style.display = 'none';
        avanzar();
      }, 900);
    }

    function avanzar() {
      estado.preguntaIndex++;
      const fase = preguntasFases[estado.faseIndex];
      if (estado.preguntaIndex >= fase.preguntas.length) {
        estado.faseIndex++;
        estado.preguntaIndex = 0;
      }
      if (estado.faseIndex >= preguntasFases.length) {
        finalizar();
      } else {
        cargarPregunta();
        actualizarScore();
      }
    }

    function finalizar() {
      screen.innerHTML = `
        <div class="card">
          <h3>Resumen</h3>
          <p>Aciertos: ${estado.aciertos}</p>
          <p>Errores: ${estado.errores}</p>
          <p>Comisión total: ${estado.comision}</p>
          <p>Ronda terminada. Puedes reintentar hasta lograr 100% de rendimiento.</p>
          <button id="btn-retry-now" class="btn">Reintentar</button>
        </div>
      `;
      btnRetry.style.display = 'inline-block';
      document.getElementById('btn-retry-now').addEventListener('click', iniciar);
    }

    // inicialización
    renderBienvenida();
    // si quieres iniciar automáticamente, llama iniciar() aquí
  </script>
</body>
</html>
