<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GAMA ¬∑ Postventa (M√≥dulo 4)</title>
<style>
:root{
  --oro:#b98b3b; --cobre:#b66b3a; --beige:#f2eadf; --marfil:#fffaf0; --accent:#3b2f2a; --muted:#6f5f52;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:Inter,Arial,Helvetica,sans-serif;
  background:var(--marfil); color:var(--accent); min-height:100vh; display:flex; flex-direction:column;
}
header{background:linear-gradient(90deg,var(--oro),var(--cobre)); color:#fff; padding:14px 18px; font-weight:700}
.container{width:100%; max-width:980px; margin:18px auto; padding:12px}
.card{background:var(--beige); border-radius:14px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,0.07)}
.h1{font-size:20px; color:var(--accent); margin:0 0 8px}
.small{color:var(--muted); font-size:14px}
#contador{color:var(--cobre); font-weight:700; margin-top:12px}
.options{margin-top:16px}
.options button{display:block; width:100%; max-width:680px; margin:8px auto; text-align:left; padding:12px 14px; border-radius:10px; border:2px solid var(--cobre); background:#fff; cursor:pointer; font-size:16px}
.options button:hover{background:linear-gradient(90deg,#fff,#f7f2ea)}
.progress{margin-top:12px; color:var(--muted)}
.popup{
  display:none; position:fixed; left:50%; top:18%; transform:translateX(-50%);
  background:#fff; padding:18px; border-radius:12px; border:2px solid var(--oro);
  box-shadow:0 12px 40px rgba(0,0,0,0.14); width:90%; max-width:420px; z-index:120;
}
.center{display:flex; flex-direction:column; align-items:center; gap:8px}
.footer{background:var(--oro); color:#fff; padding:10px; text-align:center; font-size:13px;}
.hidden{display:none}
@media(min-width:720px){ .options button{max-width:700px} }
</style>
</head>
<body>
<header>üå≥ GAMA ¬∑ Seguimiento Postventa ‚Äî M√≥dulo 4</header>
<main class="container">
  <div class="card" id="welcome">
    <div class="h1">Bienvenida ‚Äî Seguimiento Postventa</div>
    <div class="small">Instrucciones: haz <strong>un clic</strong> para activar sonido. Responde cada pregunta; tendr√°s un tiempo por pregunta. Usa los popups para leer feedback y continuar.</div>
    <div style="margin-top:14px" class="center">
      <button id="startBtn">üéß Iniciar ejercicio</button>
      <div id="contador" class="small">Tiempo: <span id="timeLabel">30</span>s</div>
    </div>
  </div>

  <div class="card hidden" id="game">
    <div id="qwrap">
      <!-- pregunta renderizada por JS -->
    </div>
    <div class="progress small">Progreso: <span id="progress">0 / 0</span></div>
  </div>
</main>

<!-- popup -->
<div class="popup" id="popup" role="dialog" aria-modal="true">
  <div id="popupText" class="small"></div>
  <div style="margin-top:12px; text-align:right">
    <button id="popupBtn">Continuar</button>
  </div>
</div>

<footer class="footer">
  Magali Sauceda¬Æ | Mentora Inmobiliaria | Fundadora de Ra√≠ces de √âxito ‚Äî Metodolog√≠a SPIN‚Ñ¢
</footer>
<script>
/* ----------------- helpers de audio (codifica rutas con espacios) --------------- */
function A(src){
  try { return new Audio(encodeURI(src)); } catch(e){ return new Audio(src); }
}

/* ------------- archivos EXACTOS que subiste (no cambiar nombres) ------------- */
const FILES = {
  music: "m√∫sica de videojuegos arcade retro-297305.mp3",
  tiktak: "TIKTACK.mp3",
  pop: "POP.mp3",
  bien: "BIEN.mp3",
  no: "NO.mp3",
  tonto: "TONTO.mp3",
  aplausos: "APLAUSOS.mp3",
  fanfarrea: "FANFARREA.mp3",
  bonus: "BONUS.mp3"
};

/* ---------------- precarga de sonidos ---------------- */
const S = {
  music: A(FILES.music),
  tiktak: A(FILES.tiktak),
  pop: A(FILES.pop),
  bien: A(FILES.bien),
  no: A(FILES.no),
  tonto: A(FILES.tonto),
  aplausos: A(FILES.aplausos),
  fanfarrea: A(FILES.fanfarrea),
  bonus: A(FILES.bonus)
};
S.music.loop = true; S.tiktak.loop = true;
S.music.volume = 0.55; S.tiktak.volume = 0.35;

/* ---------------- PREGUNTAS (editable) ---------------- */
const PREG = [
  { q:"¬øQu√© es el seguimiento postventa en el √°mbito inmobiliario?", 
    options:["Llamar solo si el cliente se queja","Mantener contacto programado para asegurar satisfacci√≥n y futuras ventas","Enviar mensajes sin objetivo definido"], correct:1, explain:"Mantener contacto estructurado evita olvidos y detecta oportunidades." },
  { q:"¬øQu√© significa NPS (Net Promoter Score)?",
    options:["Mide la probabilidad de que un cliente te recomiende","Nivel Promedio de Servicio","Nuevo Plan de Seguimiento"], correct:0, explain:"NPS mide la recomendaci√≥n (1-10), √∫til para pedir referidos." },
  { q:"¬øQu√© es un pipeline de ventas?",
    options:["Sistema para visualizar en qu√© etapa est√° cada cliente","Documento de escritura p√∫blica","Lista de precios"], correct:0, explain:"Pipeline = etapas y acciones para mover prospectos a cierre." },
  { q:"¬øCu√°l es el objetivo del cronograma postventa?",
    options:["Organizar los contactos con prop√≥sito claro y fechas","Llamar cuando te acuerdes","Enviar publicidad masiva"], correct:0, explain:"Cada contacto tiene un objetivo: afianzar, medir, referir." },
  { q:"¬øCu√°ndo pedir referidos?",
    options:["Cuando el cliente demuestra satisfacci√≥n real","Antes de que firme","Solo si te lo pide"], correct:0, explain:"Pedir referidos cuando el cliente es promotor es m√°s efectivo." },
  { q:"¬øQu√© herramientas ayudan al seguimiento profesional?",
    options:["CRM, plantillas y automatizaciones","Mensajes improvisados","Post-its"], correct:0, explain:"Herramientas aseguran consistencia y medici√≥n." }
];

let idx = 0, score = 0;
let questionTimer = null, timeLeft = 30;

/* elementos DOM */
const startBtn = document.getElementById('startBtn');
const welcome = document.getElementById('welcome');
const game = document.getElementById('game');
const qwrap = document.getElementById('qwrap');
const popup = document.getElementById('popup');
const popupText = document.getElementById('popupText');
const popupBtn = document.getElementById('popupBtn');
const timeLabel = document.getElementById('timeLabel');
const progress = document.getElementById('progress');

/* inicializa valores de progreso */
progress.textContent = `${idx+1} / ${PREG.length}`;

/* funci√≥n para asegurar play tras interacci√≥n (pol√≠tica del navegador) */
function ensureAudioOnFirstInteraction(){
  document.body.addEventListener('click', function once(){
    S.music.play().catch(()=>{});
    document.body.removeEventListener('click', once);
  }, { once:true });
}

/* Start */
startBtn.addEventListener('click', ()=>{
  ensureAudioOnFirstInteraction();
  S.music.play().catch(()=>{});
  welcome.classList.add('hidden');
  game.classList.remove('hidden');
  idx = 0; score = 0;
  renderQuestion();
});

/* renderiza pregunta actual */
function renderQuestion(){
  clearInterval(questionTimer);
  S.tiktak.currentTime = 0;
  timeLeft = 30; timeLabel.textContent = timeLeft;
  // iniciar tiktak
  S.tiktak.play().catch(()=>{});
  const P = PREG[idx];
  progress.textContent = `${idx+1} / ${PREG.length}`;
  qwrap.innerHTML = `
    <div class="card" style="padding:14px">
      <h2>${P.q}</h2>
      <div class="options" id="optionsWrap">
        ${P.options.map((o,i)=>`<button data-i="${i}" onclick="selectOption(${i})">${String.fromCharCode(65+i)}) ${o}</button>`).join('')}
      </div>
    </div>
  `;
  // contador por pregunta
  questionTimer = setInterval(()=>{
    timeLeft--; timeLabel.textContent = timeLeft;
    if(timeLeft <= 5) document.getElementById('contador').style.color = 'var(--cobre)';
    if(timeLeft <= 0){
      clearInterval(questionTimer);
      S.tiktak.pause();
      S.no.play().catch(()=>{});
      showPopup('‚è∞ Tiempo agotado. ' + P.explain, false);
    }
  },1000);
}

/* selecciona opci√≥n (llamada desde onclick de botones) */
function selectOption(sel){
  // prevenir doble click
  const btns = document.querySelectorAll('#optionsWrap button');
  btns.forEach(b=>b.disabled=true);
  clearInterval(questionTimer);
  S.tiktak.pause();
  S.pop.play().catch(()=>{});
  const P = PREG[idx];
  const correcto = (sel === P.correct);
  if(correcto){
    S.bien.play().catch(()=>{});
    showPopup('‚úÖ Correcto. ' + P.explain, true);
  } else {
    S.no.play().catch(()=>{});
    showPopup('‚ùå No es correcto. ' + P.explain, false);
  }
}

/* mostrar popup */
function showPopup(text, positive){
  popupText.textContent = text;
  popup.style.display = 'block';
  // si es positivo y √∫ltima pregunta, pausa m√∫sica para fanfarrea en closePopup
  popup.dataset.positive = positive ? '1' : '0';
}

/* cerrar popup y control de flujo */
function closePopup(){
  popup.style.display = 'none';
  const positive = popup.dataset.positive === '1';
  // si acert√≥ (positive true) avanzamos; si no, repetimos misma pregunta
  if(positive){
    idx++;
    if(idx < PREG.length){
      // peque√±a espera para que el usuario perciba el resultado
      setTimeout(renderQuestion, 450);
      return;
    } else {
      // termin√≥ todo: reproducir fanfarria/aplausos y mostrar mensaje final
      S.music.pause();
      S.fanfarrea.play().catch(()=>{ S.aplausos.play().catch(()=>{}); });
      qwrap.innerHTML = `<div class="card"><h2>üéâ ¬°Has completado el m√≥dulo con √©xito!</h2><p class="small">Puntuaci√≥n: ${score} / ${PREG.length}</p></div>`;
      // mostrar botones finales opcionales
      return;
    }
  } else {
    // repetir la misma pregunta: reiniciar contador y renderizar de nuevo (sin avanzar idx)
    setTimeout(renderQuestion, 300);
  }
}

/* conectar popupBtn al cierre */
popupBtn.addEventListener('click', closePopup);

/* Exponer selectOption global para usar onclick inline */
window.selectOption = selectOption;

/* asegura que el primer click del usuario permita audio en m√≥viles/navegadores */
ensureAudioOnFirstInteraction();
</script>
</body>
</html>
